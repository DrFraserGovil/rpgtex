%%Set the D&D specific fonts

\ExplSyntaxOn
% \sys_if_engine_xetex:T
% {
%   % Spit out a warning if XeLaTeX is detected for the PDFLaTeX-based D&D theme
%   \msg_new:nnn { rpg } { dnd-xelatex-warning }{#1}
% %   { #1 }
%   \msg_warning:nnx { rpg } { dnd-xelatex-warning }
%     {
%       The~dnd~theme~is~designed~for~pdfLaTeX.~Compiling~with~XeLaTeX~may~cause
%       font~and~character~issues~due~to~reliance~on~the~legacy~NFSS~system.
%     }
% }

\RequirePackage{currfile}
\ifx\@onlypreamble\@notprerrc \else
	\RequirePackage[T1]{fontenc} %%Even in xelatex, this allows T1 fonts to be loaded in
	\RequirePackage{Royal}
	% \RequirePackage{bookman} %% Sets the default font to bookman
	% \usepackage{fontspec}
	\RequirePackage[type1]{gillius2} %%loads in the gilliustwo font
	\RequirePackage[notext,nomath,nott]{kpfonts}
\fi
\providecommand\jkfont{\fontfamily{jkpss}\selectfont}


\setmainfont[ Path= \RpgPackagePath/themes/dnd/fonts/ ]{Bookman~Old~Style~Std}
[
  UprightFont = *~Regular,
  BoldFont= *~Bold,
  ItalicFont=*~Italic,
  BoldItalicFont=*~Bold~It,
  SmallCapsFont=EBGaramondSC08-Regular.otf
]


\providecommand\titlemode{\linespread{.9} \color{titlered} \scshape}

\RpgSetFont[
	%Sections
	title-style			= {\bf\scshape\fontsize{30}{50}\selectfont\color{white}},
	subtitle-family		={\scshape},
	subtitle-style 		= {\LARGE \textcolor{white}},
	part-style			= {\color{titlered}\fontsize{50}{30}\selectfont},
	chapter-style		= {\titlemode \Huge},
	section-style		= {\titlemode \huge},,
	subsection-style	= {\titlemode \Large},,
	subsubsection-style	= {\titlemode \large},,
	paragraph-style	= {\bfseries \slshape},
	subparagraph-style	= {\bfseries \slshape},
	%Tables
	table-title-family	= {\jkfont},
	table-title-style	= {\bfseries\large\scshape},
	table-header-family	= {\jkfont},
	table-body-family	= {\gilliustwo},
	%tip boxes
	tip-title-family= {\jkfont},
	tip-title-style	= {\bfseries\scshape},
	tip-body-family	= {\gilliustwo},
	tip-body-style	= {\small},
	%sidebars
	sidebar-title-family= {\jkfont},
	sidebar-title-style	= {\bfseries\scshape},
	sidebar-body-family	= {\gilliustwo},
	sidebar-body-style	= {\small},
	%narration
	narration-family	= {\gilliustwo},
	narration-style		= {\small},
	% TOC
	toc-part-style		= {\Large \scshape \color{titlered}},
	toc-chapter-style	= {\large \scshape \color{titlered}},
	toc-section-style	= {\normalsize},
	%stat block
	stat-block-title-style= {\bfseries\scshape \LARGE},
	stat-block-body-family={\gilliustwo},
	stat-block-body-style={\small},
	stat-block-section-family={\jkfont},
	stat-block-section-style={\color{titlered} \scshape \large},
	%%misc
	footer-style		= {\color{pagegold}\scriptsize},
	page-number-style	= {\color{pagegold}\scriptsize},
	drop-cap-family		= {\Royal},
]{}

%%modify fonts if in handout mode
\str_if_eq:NNT \g__rpg_base_class_tl {article}
{
	\RpgSetFont[
		title-style			= {\bf\scshape\Huge\color{titlered}},
		subtitle-style			= {\bf\normalsize\color{titlered}},
	]
	{}
}
