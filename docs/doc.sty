
\usepackage{xltabular}
\usepackage{listings}
\lstset{
  basicstyle=\ttfamily,
  columns=fullflexible, % Uses the actual font width (best match for \verb)
  flexiblecolumns=true, % Allows for variable-width fonts (important for \ttfamily)
  breaklines=true,
  breakatwhitespace=true,
  showtabs=false,
  tabsize=1,
}
\usepackage{makecell}
\usepackage{adjustbox}
\geometry{
left=3cm
}
\ExplSyntaxOn{}
% Define a function to process the list of macros
\cs_new_protected:Npn \__rpg_doc_macro_list:n #1
{

	\noindent\ignorespaces\begin{minipage}[t]{2.5cm}
		\begin{flushright}
			 \clist_map_inline:nn { #1 }
			{
				\maxsizebox{2.49cm}{3cm}{\small\verb|##1|} \\
			}
		\end{flushright}
	\end{minipage}
}

\NewDocumentEnvironment{macrolist}{+b}{
	% \vspace{1em}
	\ignorespaces
	\renewcommand{\arraystretch}{2}
	\setlength\parindent{0pt}
	\setlength\parskip{5pt}
    % \leavevmode % Equivalent to a robust \noindent for initiating mode
    % \hspace{-1.5cm}%
	\setlength{\LTleft}{-2.9cm}
	\begin{xltabular}{\dimexpr\linewidth+2.9cm\relax}{rX}
		#1
    \end{xltabular}}{}

\NewDocumentCommand{\lMacroName}{m}{
	\texttt{\textbackslash\_\_#1}
}

\NewDocumentCommand{\macrosection}{m}
{
\vspace{1em}\par\noindent
	{\RpgFontSubsubsection{} #1}
	\par\noindent
}

\newcommand\DualExampleRender[1]
		{
			\noindent\begin{minipage}[t]{0.5\linewidth}\small 
			\noindent\lstinputlisting{parts/examples/#1}
			\end{minipage}\begin{minipage}[t]{0.5\linewidth}
		\input{parts/examples/#1}
		\end{minipage}
		}

\NewDocumentCommand{\RpgMacro}{s o m +m +m +m}{\__rpg_doc_macro_list:n { #3 } & #4

	\tl_if_novalue:nF{#2}
	{
		\label{Macro:#2}
		\cmdidx{#2}	
	}
	
		
	\str_if_empty:nF{#5}
	{~
		\macrosection{Syntax}

		\IfBooleanTF{#1}
		{#5}
		{\verb|#5|}
	}

	\str_if_empty:nF{#6}
	{
	\macrosection{Details}
	{#6}
	}
	\\
}

\NewDocumentEnvironment{fontlist}{+b}{
	\vspace{1em}
	
    % \hspace{-1.5cm}
	\let\__rpg_colsep:&
	\noindent\begin{xltabular}{\linewidth}{llX}
		Font~Element & Values & Usage \\
		#1
    \end{xltabular}}{}

	\NewDocumentCommand{\FontElement}{m +m +m}{\makecell[lt]{  \__rpg_doc_macro_list:n { #1 }} &

	\makecell[lt]{  \__rpg_doc_macro_list:n { {#2-family},{#2-style} }}

	&

	#3
	\\
}


\newcommand{\code}[1]{\texttt{(\detokenize{#1})}}
\usepackage{verbatimbox}
\newcommand\tabverbExample[1]
{
	\verb|#1| &  #1 \\
}


	\tl_new:N \l__temp_dice
	\NewDocumentCommand{ \DndTempDiceFormat }{m m m}
	{
		% #1: Dice Number, #2: Dice Sides, #3: Modifier
		\tl_if_blank:VTF {#1}
		{
			% CASE: called without a dice count (i.e. d8), equal to 1d8
			\tl_set:Nn\l__temp_dice{1}
		}
		{
			\tl_set:Nn \l__temp_dice{#1}
		}
		\tl_set:Nn \l_tmp_mean_tl { \fp_eval:n {
				floor ( \tl_use:N{\l__temp_dice} * ( #2 + 1 ) / 2 ) + (#3)
			}}
			\l_tmp_mean_tl{}~(#1 d#2
			\fp_compare:nNnTF { #3 } { = } { 0 }{}{#3})
	}
	\ExplSyntaxOff{}
