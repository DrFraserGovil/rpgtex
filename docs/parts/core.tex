
\chapter{Installation \& Usage}

	\section{Getting \rpgtex}

		There are a number of different ways to acquire \rpgtex{}. Once you have installed it, it is vital to ensure that it is \href{\ref{S:Configuration}}{properly configured} (see below).


		\subsection{texmf Installation}

			The simplest way to use \rpgtex{} is to install it on the \texttt{texmf} path, where the compiler can automatically find it:

			\begin{lstlisting}
git clone https://github.com/DrFraserGovil/rpgtex.git "$(kpsewhich -var-value TEXMFHOME)/tex/latex/rpgtex"
			\end{lstlisting}

			This will clone the repository into your\LaTeX{} path.

		\subsection{Indirect Installation}

			If you want to tinker with \rpgtex{} -- such as by creating a new theme -- it is helpful to have it in a more accessible location. Clone the repository into a location of your choice:

			\begin{lstlisting}
git clone https://github.com/DrFraserGovil/rpgtex.git ~/your/rpgtex/directory
			\end{lstlisting}

			You then have two options to make the package visible to the compiler:

			\subsubsection{Use TEXINPUTS}

			Setting the environment variable \verb|TEXINPUTS| allows the compiler access:
				\begin{lstlisting}
	TEXINPUTS=~/your/rpgtex/directory/::
				\end{lstlisting}
				(Or similar commands, depending on your shell -- in \texttt{fish} you would call \verb|set TEXINPUTS dir|).

			\subsubsection{Use Symlinks}

			You can symlink the install location to the texmf directory, allowing the compiler to act as if you had performed the texmf installation:

			\begin{lstlisting}
				ln -sf ~/your/rpgtex/directory "$(kpsewhich -var-value TEXMFHOME)/tex/latex/rpgtex"
			\end{lstlisting}

		\subsection{Overleaf (Not recommended!)}

			We do not recommend using Overleaf since the free-tier subscription has reduced compilation times drastically, making compiling documents using complex packages such as this one extremely difficult. Nevertheless:

			\begin{enumerate}
				\item  Download this GitHub repository as a ZIP archive using the Clone or download link above.
    			\item On Overleaf, click the New Project button and select Upload Project. Upload the ZIP archive you downloaded from this repository.
				\item Manually create the file \texttt{rpg-config.cfg} with the contents ``\verb|\edef\RpgPackagePath{../}|''. This replaces the configuration step described below.

			\end{enumerate}


	\section{Configuring \rpgtex{}} \label{S:Configuration}

		Wherever one installs \rpgtex{} from, it is vital that it is properly configured. From within the \rpgtex{}-root directory, call:

		\begin{lstlisting}
			./configure
		\end{lstlisting}
		Or -- if one is (reasonably!) wary about running arbitrary executables -- manually create the relevant file:
		\begin{lstlisting}
			cd <rpgtex root directory>
			cmd="\edef\RpgPackagePath{$(pwd)}"
			echo $cmd >> core/rpg-config.cfg
		\end{lstlisting}

		\begin{RpgTip}{Why is configuration necessary?}
			\TeX{} is generally set up so that when a file calls \verb|include| or \verb|input| it is possible to use filepaths relative to the package itself. \texttt{rpg.sty} can call \verb|\input{core/font.sty}| and it will know to first check for the file relative to rpg.sty; even if the package resides within the texmf path and the user has no idea where \texttt{rpgroot/rpg.sty}, or \texttt{rpgroot/core/font.sty}, are.

			An annoying exception to this is fonts and typefaces. \texttt{xelatex} searches for fonts based on \textit{filepaths relative to the current working directory} -- or from those installed in as system fonts.

			Since \texttt{rpgtex} includes several (license free) typefaces as part of the provided themes, this poses a problem. We must either require that:
			\begin{enumerate}
				\item \rpgtex{} documents can only be prepared in restricted locations relative to the install location of \rpgtex{}.
				\item Users must identify and specify the \rpgtex{} root path when preparing a document
				\item Users must install the provided fonts to the system path
				\item \rpgtex{} must be configured to know `where it is', and so provide an absolute filepath to the internal fonts.
			\end{enumerate}
			The Configuration step is the most portable and easiest-to-use of these options.
		\end{RpgTip}

		Without a \texttt{core/rpg-config.cfg} file, any document which includes \rpgtex{} will fail to compile.
	\newpage

	\section{Package \& Class Usage}

		\rpgtex{} can be used either as a standalone package, or as part of a number of classes

		\subsection{Standalone Package}
			The standalone package can be used directly by including the \rpgtex{} package:
			\begin{lstlisting}
				\documentclass{arbitrary-class}

				\usepackage[options]{rpgtex}

				\begin{document}
				....
			\end{lstlisting}

			This will load only the core commands into the document, and (unless called explicitly) no themes will be imported. Using the package in this way does not activate any of the commands which change the overall geometry, background or headers of the document.

		\subsection{Classes}

			\rpgtex{} can also be loaded through a number of classes which drastically alter the appearance of the document, defining new geometries backgrounds and adding headers.

			The provided classes are:
			\begin{enumerate}
				\item \texttt{rpgbook} (page \pageref{S:bookClass}). Based on the standard book class, this is designed for larger RPG documents.
				\item \texttt{rpghandout} (page \pageref{S:handoutClass}). Based on the article class, this is designed for shorter documents
				\item \texttt{rpgcard} (page \pageref{S:cardClass}). A small-document class designed for creating modular `handout' cards for items, spells or abilities.
			\end{enumerate}
	\section{Compiling}

		\rpgtex{} uses the \texttt{fontspec} package to allow custom fonts, and therefore requires compiling with \texttt{xelatex} or \texttt{luatex}:

		\begin{lstlisting}
			xelatex main.tex		#works
			luatex main.tex			#works
			pdflatex main.tex #fails
		\end{lstlisting}


\chapter{Core Commands}
