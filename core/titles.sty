\ExplSyntaxOn

\input{core/lowlevel/image_pages}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Part pages (with images)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% internal arguments defined in core/lowlevel/image_pages.tex
\RenewDocumentCommand{\part}{s o m }
{
	\bool_if:NTF{#1}
	{ %%starred version uses the underlying class part
		\__rpg_orig_part{#3}
	}
	{
		\bool_if:NTF{\str_if_eq_p:nn{#2}{none}}
		{ %%use default version if optional argument = 'none'
			\__rpg_orig_part{#3}
		}
		{
			%%otherwise use the custom theme part (RpgDrawPartPage), with or without a background image
			\__custom_part_page:nn{#2}{#3}
		}
	}
}

%%The original definition to be overwritten by the themes 
\NewDocumentCommand\RpgDrawPartPage{m}
{
	\node at (current~page.center) {\parbox[t]{0.8\linewidth}{\centering \RpgFontPart Part~\thepart \\ #1}};
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Title pages (with images)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%Add new commands in vein of \title, \author etc.
\NewDocumentCommand{\subtitle}{m}
{
	\gdef\@subtitle{#1}
}
\NewDocumentCommand{\cover}{m}
{
	\gdef\@cover{#1}
}

%set default values to blank
\subtitle{} 
\cover{}

%%%%%%%%%%%%%%%% %%%%%%%%%%%%%%
%Commands called by \maketitle
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%Used for books, similar ot part page, draws the contents of this macro over the top of the background image specified by \@cover
\NewDocumentCommand\RpgDrawCover{}{}

%%%Used for articles, a lightweight, text-only title. Not rendered within a tikzpicture.
\NewDocumentCommand\RpgSimpleTitle{}{\__rpg_orig_title}

%%Switching command used by classes to choose to use a full-page drawn title, or a simple text title
\NewDocumentCommand{\RpgUseCoverPage}{m}{
	\str_case:nnF { #1 }
    {
        {true}  { \bool_set_true:N  \g__rpg_use_cover_page_bool }
        
        {false} { \bool_set_false:N \g__rpg_use_cover_page_bool }
    }
    {
        % Fallback Case: Invalid value detected. Raise an error.
        \msg_error:nnn { rpg } { bad_switch_value } { #1 }
    }
}

\ExplSyntaxOff
